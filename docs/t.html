<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Lista M3U</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }
        textarea {
            width: 100%;
            height: 200px;
            margin-bottom: 20px;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
        }
        pre {
            background-color: #f4f4f4;
            padding: 10px;
            border: 1px solid #ccc;
        }
    </style>
</head>
<body>

    <h1>Gerador de Lista M3U</h1>

    <textarea id="input" placeholder="Cole sua lista M3U aqui"></textarea>
    <button onclick="processarLista()">Processar Lista</button>

    <h2>Lista Gerada</h2>
    <pre id="output"></pre>

    <script>
        function processarLista() {
            // Obtém o texto da textarea de entrada
            var entrada = document.getElementById('input').value;
            var linhas = entrada.split('\n');

            var listaFinal = [];
            
            // Expressão regular para identificar os canais brasileiros
            var filtroBrasileiro = /CANAIS | (BR|BRASIL|Brazil)/i;

            for (var i = 0; i < linhas.length; i++) {
                // Reorganiza a linha e resume o conteúdo
                if (linhas[i].startsWith('#EXTINF')) {
                    var nomeCanal = linhas[i].split(',')[1]; // Nome do canal
                    var grupo = linhas[i].match(/group-title="([^"]+)"/); // Grupo do canal

                    // Verifica se o canal pertence ao grupo brasileiro
                    if (grupo && filtroBrasileiro.test(grupo[1])) {
                        // Verifica o link na linha seguinte
                        var link = linhas[i + 1] ? linhas[i + 1].trim() : null;

                        // Converte .ts para .m3u8 se necessário
                        if (link && link.endsWith('.ts')) {
                            link = link.replace('.ts', '.m3u8');
                        }

                        // Adiciona à lista final no formato resumido
                        listaFinal.push('#EXTINF:-1,' + nomeCanal + '\n' + link);
                    }
                }
            }

            // Atualiza a textarea de saída
            document.getElementById('output').textContent = listaFinal.join('\n');
        }
    </script>

</body>
</html>
