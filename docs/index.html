<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TV DO BILL - ALGUNS CANAIS PODEM ESTAR FORA, AGUARDE ATUALIZAÇÃO - USE O VIA BROWSER, C LITE BROWSER, OU PESQUISE COMO DESATIVAR CONEXÃO SEGURA DO SEU NAVEGADOR</title>
    <link href="https://vjs.zencdn.net/7.20.2/video-js.css" rel="stylesheet" />
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #000;
            color: #fff;
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow-y: auto;
        }
        #container { display: flex; flex-direction: column; width: 100%; height: 100%; }
        #header {
            background-color: rgba(0, 128, 0, 0.8);
            padding: 10px; text-align: center;
            font-size: 1.2em; border-bottom: 1px solid #ffcc00;
        }
        #search-bar { padding: 10px; background-color: #333; text-align: center; }
        #search-input {
            width: 95%; padding: 10px; border: none;
            border-radius: 5px; font-size: 1em;
        }
        #main { display: flex; flex: 1; overflow-y: auto; }
        #player {
            flex: 2; background-color: rgba(0, 0, 0, 0.8);
            display: flex; justify-content: center; align-items: center;
            overflow: hidden;
        }
        .video-js, .vjs-tech { width: 100% !important; height: 100% !important; background-color: #000; }
        #sidebar {
            flex: 1; background-color: rgba(34, 34, 34, 0.8);
            overflow-y: auto; padding: 10px;
            border-left: 2px solid #ffcc00;
        }
        #sidebar ul { list-style-type: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 10px; }
        #sidebar li {
            background-color: rgba(50, 50, 50, 0.8); border-radius: 8px; padding: 10px;
            display: flex; align-items: center; cursor: pointer;
            transition: background-color 0.3s ease;
        }
        #sidebar li:hover { background-color: #ffcc00; }
        #sidebar img {
            width: 50px; height: 50px; margin-right: 10px; border-radius: 50%;
            border: 2px solid #ffcc00; object-fit: cover;
        }
        .video-js.vjs-fullscreen { position: fixed; top: 0; left: 0; }
        .video-js .vjs-big-play-button {
            background-color: rgba(76, 175, 80, 0.8); border-radius: 50%; font-size: 2.5em;
        }
        .video-js .vjs-big-play-button:hover { background-color: rgba(76, 175, 80, 1); }
        ::-webkit-scrollbar { width: 10px; }
        ::-webkit-scrollbar-thumb { background-color: #ffcc00; border-radius: 10px; }
        .vjs-error-display { display: none !important; }
    </style>
</head>
<body>
    <div id="container">
        <div id="header">
            TV DO BILL - ALGUNS CANAIS PODEM ESTAR FORA, AGUARDE ATUALIZAÇÃO - USE O VIA BROWSER, C LITE BROWSER, OU PESQUISE COMO DESATIVAR CONEXÃO SEGURA DO SEU NAVEGADOR - LISTA IPTV: https://bit.ly/bill-iptv - EPG https://bit.ly/tvdobill-epg
        </div>
        <div id="main">
            <div id="sidebar">
                <div id="search-bar">
                    <input type="text" id="search-input" placeholder="Buscar canal..." />
                </div>
                <ul id="lista-canais"></ul>
            </div>
            <div id="player">
                <video id="video-player" class="video-js vjs-default-skin" controls></video>
            </div>
        </div>
    </div>

    <script src="https://vjs.zencdn.net/7.20.2/video.min.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const listaURL = "https://raw.githubusercontent.com/listadobill/tv/refs/heads/main/zteste.m3u";
            const listaCanaisElemento = document.getElementById("lista-canais");
            const searchInput = document.getElementById("search-input");
            const video = videojs("video-player", {
                controls: true, autoplay: false, preload: "auto", fluid: true, responsive: true,
            });

            fetch(listaURL)
                .then(res => res.text())
                .then(data => {
                    const linhas = data.split("\n");
                    let canais = [];

                    for (let i = 0; i < linhas.length; i++) {
                        if (linhas[i].startsWith("#EXTINF")) {
                            let nome = linhas[i].split(",")[1]?.trim() || "Sem Nome";
                            let url = linhas[i + 1]?.trim();
                            if (url && !canais.find(c => c.url === url)) {
                                canais.push({ name: nome, url: url });
                            }
                        }
                    }

                    // Ordena em ordem alfabética
                    canais.sort((a, b) => a.name.localeCompare(b.name, 'pt', { sensitivity: 'base' }));

                    function renderizarCanais(lista) {
                        listaCanaisElemento.innerHTML = "";
                        lista.forEach(canal => {
                            let li = document.createElement("li");
                            li.innerHTML = `<img src="https://via.placeholder.com/50" alt="${canal.name}">${canal.name}`;
                            li.addEventListener("click", () => {
                                video.src({ type: "application/x-mpegURL", src: canal.url });
                                video.play();
                                video.requestFullscreen();
                                reconectar(canal.url);
                            });
                            listaCanaisElemento.appendChild(li);
                        });
                    }

                    renderizarCanais(canais);

                    searchInput.addEventListener("input", () => {
                        const filtro = searchInput.value.toLowerCase();
                        renderizarCanais(canais.filter(c => c.name.toLowerCase().includes(filtro)));
                    });
                });

            function reconectar(url) {
                video.off('error').off('ended').off('stalled');
                const tentarReconectar = () => {
                    video.off('error').off('ended').off('stalled');
                    video.src({ type: "application/x-mpegURL", src: url });
                    video.play();
                    video.on('error', tentarReconectar);
                    video.on('ended', tentarReconectar);
                    video.on('stalled', tentarReconectar);
                };
                video.src({ type: "application/x-mpegURL", src: url });
                video.play();
                video.on('error', tentarReconectar);
                video.on('ended', tentarReconectar);
                video.on('stalled', tentarReconectar);
            }
        });
    </script>
</body>
</html>
